<!DOCTYPE html>
<html lang="vi">
<head>
  <meta charset="UTF-8">
  <title>Trắc nghiệm</title>
  <style>
    body { font-family: Arial, sans-serif; padding: 20px; }
    .question { margin-bottom: 20px; padding: 10px; border: 1px solid #ccc; border-radius: 8px; }
    .correct { color: green; }
    .wrong { color: red; }
    .answer-key { font-style: italic; font-size: 0.9em; }
  </style>
</head>
<body>

  <h1>Bài trắc nghiệm</h1>
  <div id="quiz-container"></div>
  <button onclick="submitQuiz()">Nộp bài</button>
  <h2 id="score"></h2>

  <script>
    let questions = [];
    let userAnswers = [];

    fetch('questions.json')
      .then(response => response.json())
      .then(data => {
        questions = data;
        renderQuiz();
      });

    function renderQuiz() {
      const container = document.getElementById('quiz-container');
      container.innerHTML = '';
      questions.forEach((q, index) => {
        const div = document.createElement('div');
        div.className = 'question';
        let html = `<strong>Câu ${index + 1}:</strong> ${q.question}<br>`;
        q.options.forEach((opt, i) => {
          html += `
            <label>
              <input type="radio" name="q${index}" value="${i}"> ${opt}
            </label><br>
          `;
        });
        div.innerHTML = html;
        container.appendChild(div);
      });
    }

    function submitQuiz() {
      userAnswers = questions.map((_, i) => {
        const radios = document.getElementsByName('q' + i);
        for (let r of radios) {
          if (r.checked) return parseInt(r.value);
        }
        return null;
      });

      let correct = 0;
      const container = document.getElementById('quiz-container');
      container.innerHTML = '';

      questions.forEach((q, i) => {
        const div = document.createElement('div');
        div.className = 'question';
        let html = `<strong>Câu ${i + 1}:</strong> ${q.question}<br>`;
        q.options.forEach((opt, j) => {
          const isSelected = userAnswers[i] === j;
          const isCorrect = q.answer === j;
          let className = '';
          if (isCorrect) className = 'correct';
          else if (isSelected) className = 'wrong';

          html += `
            <label class="${className}">
              <input type="radio" name="q${i}" value="${j}" ${isSelected ? 'checked' : ''} disabled>
              ${opt}
            </label><br>
          `;
        });
        html += `<div class="answer-key">Đáp án đúng: ${q.options[q.answer]}</div>`;
        if (userAnswers[i] === q.answer) correct++;
        div.innerHTML = html;
        container.appendChild(div);
      });

      document.getElementById('score').textContent = `Bạn trả lời đúng ${correct}/${questions.length} câu.`;
    }
  </script>

</body>
</html>
